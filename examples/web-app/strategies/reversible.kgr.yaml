---
name: reversible
kind: EventStrategy
provides:
  state:
    borrowed:
      description: "Borrow state for modification"
    released:
      description: "State is returned by borrower"
    reverted:
      description: "Can fully or partially revert to previous state"
    updated:
      description: "Mutate or do changes to state"
    failed:
      description: "Return true on any error"
promises:
  - reverse # will receive 'assert' rule as part of context
# For each rule 'assert' hook event 'on_failure' and provide 'state' context into each action
reacts:
  - rule: assert
    is: false
    with_event: on_failure
satisfies:
  recovered: 
    - assert: state.borrowed
    - assert: state.reverted
    - assert: state.released
  panicked:
    - if: state.failed
    - assert: notification.alert
    - assert: state.released
