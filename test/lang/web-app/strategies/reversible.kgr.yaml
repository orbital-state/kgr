---
name: reversible
kind: StateStrategy
provides:
  state:
    borrow:
      description: "Borrow state for modification"
    release:
      description: "State is returned by borrower"
    revert:
      description: "Can fully or partially revert to previous state"
    update:
      description: "Mutate or do changes to state"
    failed:
      description: "Return true on any error"
promises: 
  - reverse
# For each rule 'assert' hook event 'on_failure' and provide 'state' context into each action
reacts:
  - rule: assert
    is: false
    with_event: on_failure
satisfies:
  expected: 
    - assert: state.borrow
  recovered: 
    - assert: state.revert
  panicked:
    - if: state.failed
    - assert: notification.alert
      finally: state.release
